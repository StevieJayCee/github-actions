name: "Send Slack Message"
description: "Send a Slack message to the target channel, with build results."
inputs:
  channel-id:
    description: "Channel id to send message"
    required: false
    default: 'wp-web-team'
  results:
    description: "The output provided from Lighthouse CI"
    required: false
    default: ""
  link:
    description: "A link to the artifact/asset containing the Lighthouse CI report"
    required: false
    default: ""
runs:
  using: "composite"
  steps:
    - name: Post to Slack message on execution completed
      uses: slackapi/slack-github-action@v1.24.0
      with:
        channel-id: ${{ inputs.channel-id == null && 'B066ZPFV2GG' || inputs.channel-id }}
        payload: |
          {
              "text": "${{ inputs.message }}",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "${{ inputs.message }}"
                  }
                },
                {
                "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "The results of this lighthouse run: ${{ inputs.results }}"
                  }
                },
                {
                "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "Results can be downloaded at: ${{ inputs.link }}"
                  }
                }
              ]
            }